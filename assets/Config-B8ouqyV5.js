import{_ as K,a as D,r as v,g as n,o as b,c as C,d as e,w as t,b as u,h as x,B as A,k as o,K as G,t as i,ai as J,F as Q,n as W,D as U,q as Y,C as I,E}from"./index-CYhqdMvL.js";const Z={class:"his-config-page"},ee={class:"card-header"},le={class:"header-actions"},te={class:"log-section"},se={class:"section-header"},ae={class:"log-content"},oe={class:"test-dialog"},ne={class:"test-steps"},ue={key:0,class:"test-result"},re={__name:"Config",setup(de){const r=D({systemName:"XX医院HIS系统",version:"v2.0",baseUrl:"http://his.example.com/api",status:"connected",authType:"Basic认证",username:"admin",lastConnectTime:"2024-03-14 15:30:00",remark:"用于心电图数据对接的HIS系统配置"}),V=v([{time:"2024-03-14 15:30:00",type:"success",message:"连接成功"},{time:"2024-03-14 15:29:58",type:"info",message:"验证认证信息"},{time:"2024-03-14 15:29:57",type:"info",message:"开始连接测试"}]),y=v(!1),N=v(null),a=D({systemName:"",version:"",baseUrl:"",authType:"",username:"",password:"",remark:""}),H={systemName:[{required:!0,message:"请输入系统名称",trigger:"blur"}],baseUrl:[{required:!0,message:"请输入接口地址",trigger:"blur"}],authType:[{required:!0,message:"请选择认证方式",trigger:"change"}],username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},k=v(!1),m=v(0),c=v(!1),w=v(""),L=()=>{Object.assign(a,r),y.value=!0},F=()=>{var d;(d=N.value)==null||d.validate(l=>{l&&(Object.assign(r,a),y.value=!1,E.success("保存成功"))})},S=async()=>{k.value=!0,m.value=1,c.value=!1,w.value="";try{await new Promise(d=>setTimeout(d,1e3)),m.value=2,await new Promise(d=>setTimeout(d,1e3)),m.value=3,await new Promise(d=>setTimeout(d,1e3)),m.value=4,c.value=!0,w.value="所有测试项目通过",V.value.unshift({time:new Date().toLocaleString(),type:"success",message:"连接测试成功"})}catch(d){m.value=4,c.value=!1,w.value=d.message||"连接失败",V.value.unshift({time:new Date().toLocaleString(),type:"error",message:"连接测试失败"})}},P=()=>{V.value=[],E.success("日志已清空")};return(d,l)=>{const T=n("el-icon"),_=n("el-button"),p=n("el-descriptions-item"),h=n("el-tag"),j=n("el-descriptions"),M=n("el-scrollbar"),O=n("el-card"),g=n("el-input"),f=n("el-form-item"),B=n("el-option"),R=n("el-select"),X=n("el-form"),q=n("el-dialog"),$=n("el-result");return b(),C("div",Z,[e(O,{class:"config-card"},{header:t(()=>[u("div",ee,[l[13]||(l[13]=u("span",null,"HIS系统配置",-1)),u("div",le,[e(_,{type:"primary",onClick:S},{default:t(()=>[e(T,null,{default:t(()=>[e(x(A))]),_:1}),l[11]||(l[11]=o("测试连接 "))]),_:1}),e(_,{type:"primary",onClick:L},{default:t(()=>[e(T,null,{default:t(()=>[e(x(G))]),_:1}),l[12]||(l[12]=o("编辑配置 "))]),_:1})])])]),default:t(()=>[e(j,{column:2,border:""},{default:t(()=>[e(p,{label:"HIS系统名称"},{default:t(()=>[o(i(r.systemName),1)]),_:1}),e(p,{label:"系统版本"},{default:t(()=>[o(i(r.version),1)]),_:1}),e(p,{label:"接口地址"},{default:t(()=>[o(i(r.baseUrl),1)]),_:1}),e(p,{label:"连接状态"},{default:t(()=>[e(h,{type:r.status==="connected"?"success":"danger"},{default:t(()=>[o(i(r.status==="connected"?"已连接":"未连接"),1)]),_:1},8,["type"])]),_:1}),e(p,{label:"认证方式"},{default:t(()=>[o(i(r.authType),1)]),_:1}),e(p,{label:"账号"},{default:t(()=>[o(i(r.username),1)]),_:1}),e(p,{label:"最后连接时间",span:2},{default:t(()=>[o(i(r.lastConnectTime),1)]),_:1}),e(p,{label:"备注",span:2},{default:t(()=>[o(i(r.remark),1)]),_:1})]),_:1}),u("div",te,[u("div",se,[l[15]||(l[15]=u("h3",null,"连接日志",-1)),e(_,{type:"primary",link:"",onClick:P},{default:t(()=>[e(T,null,{default:t(()=>[e(x(J))]),_:1}),l[14]||(l[14]=o("清空日志 "))]),_:1})]),e(M,{height:"200px"},{default:t(()=>[u("div",ae,[(b(!0),C(Q,null,W(V.value,(s,z)=>(b(),C("p",{key:z,class:U(s.type)},i(s.time)+" - "+i(s.message),3))),128))])]),_:1})])]),_:1}),e(q,{modelValue:y.value,"onUpdate:modelValue":l[8]||(l[8]=s=>y.value=s),title:"编辑配置",width:"600px","destroy-on-close":!0},{footer:t(()=>[e(_,{onClick:l[7]||(l[7]=s=>y.value=!1)},{default:t(()=>l[16]||(l[16]=[o("取消")])),_:1}),e(_,{type:"primary",onClick:F},{default:t(()=>l[17]||(l[17]=[o("保存")])),_:1})]),default:t(()=>[e(X,{ref_key:"formRef",ref:N,model:a,rules:H,"label-width":"100px"},{default:t(()=>[e(f,{label:"系统名称",prop:"systemName"},{default:t(()=>[e(g,{modelValue:a.systemName,"onUpdate:modelValue":l[0]||(l[0]=s=>a.systemName=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"系统版本",prop:"version"},{default:t(()=>[e(g,{modelValue:a.version,"onUpdate:modelValue":l[1]||(l[1]=s=>a.version=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"接口地址",prop:"baseUrl"},{default:t(()=>[e(g,{modelValue:a.baseUrl,"onUpdate:modelValue":l[2]||(l[2]=s=>a.baseUrl=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"认证方式",prop:"authType"},{default:t(()=>[e(R,{modelValue:a.authType,"onUpdate:modelValue":l[3]||(l[3]=s=>a.authType=s),style:{width:"100%"}},{default:t(()=>[e(B,{label:"Basic认证",value:"basic"}),e(B,{label:"Token认证",value:"token"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"账号",prop:"username"},{default:t(()=>[e(g,{modelValue:a.username,"onUpdate:modelValue":l[4]||(l[4]=s=>a.username=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"密码",prop:"password"},{default:t(()=>[e(g,{modelValue:a.password,"onUpdate:modelValue":l[5]||(l[5]=s=>a.password=s),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(f,{label:"备注",prop:"remark"},{default:t(()=>[e(g,{modelValue:a.remark,"onUpdate:modelValue":l[6]||(l[6]=s=>a.remark=s),type:"textarea",rows:"3"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(q,{modelValue:k.value,"onUpdate:modelValue":l[10]||(l[10]=s=>k.value=s),title:"测试连接",width:"500px","destroy-on-close":!0},{default:t(()=>[u("div",oe,[u("div",ne,[u("p",{class:U({active:m.value>=1})},"1. 验证接口地址...",2),u("p",{class:U({active:m.value>=2})},"2. 验证认证信息...",2),u("p",{class:U({active:m.value>=3})},"3. 测试数据交换...",2)]),m.value===4?(b(),C("div",ue,[e($,{icon:c.value?"success":"error",status:c.value?"success":"error",title:c.value?"连接成功":"连接失败","sub-title":w.value},{extra:t(()=>[e(_,{onClick:l[9]||(l[9]=s=>k.value=!1)},{default:t(()=>l[18]||(l[18]=[o("关闭")])),_:1}),c.value?I("",!0):(b(),Y(_,{key:0,type:"primary",onClick:S},{default:t(()=>l[19]||(l[19]=[o(" 重试 ")])),_:1}))]),_:1},8,["icon","status","title","sub-title"])])):I("",!0)])]),_:1},8,["modelValue"])])}}},me=K(re,[["__scopeId","data-v-0d7f5dd9"]]);export{me as default};
