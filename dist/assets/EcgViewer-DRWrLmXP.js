import{_ as K,r as m,O as x,m as ee,g as M,o as le,c as ae,b as c,d as o,w as v,h as _,P as te,Q as ne,R as oe,S as se,T as ie,U as ce,V as re,W as ue,X as de,Y as R,Z as O,$ as ve,t as b,M as fe}from"./index-0Rub1XVr.js";const me={class:"ecg-viewer"},_e={class:"viewer-toolbar"},he={class:"tool-group"},pe={class:"tool-group"},ge={class:"tool-group"},Ve={class:"viewer-scroll-container"},be={class:"measure-layer"},ke={class:"measure-info"},we={class:"mark-layer"},Te={class:"viewer-footer"},Ie={class:"scale-info"},Me={__name:"EcgViewer",props:{data:{type:Object,required:!0,default:()=>({I:[],II:[],III:[],aVR:[],aVL:[],aVF:[],V1:[],V2:[],V3:[],V4:[],V5:[],V6:[]})}},emits:["measure","mark"],setup(E,{emit:ye}){const k=E,y=m(null),h=m(null),i=m(100),p=m(5),r=m(25),g=m(!1),V=m(!1),L=m({}),G=m(""),z=[{label:"I",value:"I"},{label:"II",value:"II"},{label:"III",value:"III"},{label:"aVR",value:"aVR"},{label:"aVL",value:"aVL"},{label:"aVF",value:"aVF"},{label:"V1",value:"V1"},{label:"V2",value:"V2"},{label:"V3",value:"V3"},{label:"V4",value:"V4"},{label:"V5",value:"V5"},{label:"V6",value:"V6"}],D=()=>{i.value=Math.min(i.value+10,200);const e=h.value,a=8*(i.value/100),t=20*r.value*a,n=80;e.width=t+n,d()},A=()=>{i.value=Math.max(i.value-10,50);const e=h.value,a=8*(i.value/100),t=20*r.value*a,n=80;e.width=t+n,d()},B=()=>{i.value=100;const e=h.value,a=8*(i.value/100),t=20*r.value*a,n=80;e.width=t+n,d()},j=()=>{const e=[5,10,20,40],a=e.indexOf(p.value);a<e.length-1&&(p.value=e[a+1],d())},F=()=>{const e=[5,10,20,40],a=e.indexOf(p.value);a>0&&(p.value=e[a-1],d())},X=()=>{const e=[12.5,25,50],a=e.indexOf(r.value);if(a<e.length-1){r.value=e[a+1];const t=h.value,n=8*(i.value/100),s=20*r.value*n,u=80;t.width=s+u,d()}},Y=()=>{const e=[12.5,25,50],a=e.indexOf(r.value);if(a>0){r.value=e[a-1];const t=h.value,n=8*(i.value/100),s=20*r.value*n,u=80;t.width=s+u,d()}},Z=()=>{g.value=!g.value,g.value&&(V.value=!1)},$=()=>{V.value=!V.value,V.value&&(g.value=!1)},d=()=>{const e=h.value;if(!e)return;const a=e.getContext("2d"),{width:t,height:n}=e;a.clearRect(0,0,t,n),q(a),N(a);const s=8*(i.value/100),u=15*s,f=2.5*s;z.forEach((l,w)=>{const T=w*(u+f);H(a,l,k.data[l.value]||[],T,u)})},H=(e,a,t,n,s)=>{const{width:u}=e.canvas,f=n+s/2;e.save(),e.font="bold 16px Arial",e.fillStyle="#333",e.textBaseline="middle",e.fillText(a.label,20,f),e.restore(),e.save(),e.beginPath(),e.strokeStyle="#000000",e.lineWidth=1.5;const l=8*(i.value/100),w=p.value*l,T=r.value/1e3*l,Q=80,U=2;t.forEach((J,W)=>{const I=Q+W*U*T;if(I>u)return;const C=f-J*w;W===0?e.moveTo(I,C):e.lineTo(I,C)}),e.stroke(),e.restore(),e.save(),e.beginPath(),e.strokeStyle="#000000",e.lineWidth=1.5;const P=60,S=p.value*l;e.moveTo(P,f-S),e.lineTo(P,f+S),e.stroke(),e.restore()},N=e=>{e.save(),e.font="12px Arial",e.fillStyle="#666",e.fillText(`增益: ${p.value}mm/mV`,10,20),e.fillText(`速度: ${r.value}mm/s`,120,20),e.fillText("小格: 1mm",230,20),e.fillText("大格: 5mm",340,20),e.restore()},q=e=>{const{width:a,height:t}=e.canvas,s=8*(i.value/100),u=s*5,f=u*5;e.beginPath(),e.strokeStyle="#ffebee",e.lineWidth=.5;for(let l=0;l<=a;l+=s)e.moveTo(l,0),e.lineTo(l,t);for(let l=0;l<=t;l+=s)e.moveTo(0,l),e.lineTo(a,l);e.stroke(),e.beginPath(),e.strokeStyle="#ffcdd2",e.lineWidth=.8;for(let l=0;l<=a;l+=u)e.moveTo(l,0),e.lineTo(l,t);for(let l=0;l<=t;l+=u)e.moveTo(0,l),e.lineTo(a,l);e.stroke(),e.beginPath(),e.strokeStyle="#ef9a9a",e.lineWidth=1;for(let l=0;l<=a;l+=f)e.moveTo(l,0),e.lineTo(l,t);for(let l=0;l<=t;l+=f)e.moveTo(0,l),e.lineTo(a,l);e.stroke()};return x(()=>k.data,e=>{Object.keys(e).length>0&&fe(()=>{d()})},{deep:!0,immediate:!0}),ee(()=>{const e=h.value;y.value;const a=8*(i.value/100),t=20*r.value*a,n=80;e.width=t+n,e.height=207.5*a,Object.keys(k.data).length>0&&d(),window.addEventListener("resize",()=>{const s=8*(i.value/100),u=20*r.value*s;e.width=u+n,e.height=207.5*s,d()})}),(e,a)=>{const t=M("el-button"),n=M("el-tooltip"),s=M("el-button-group");return le(),ae("div",me,[c("div",_e,[c("div",he,[o(s,null,{default:v(()=>[o(n,{content:"放大",placement:"top"},{default:v(()=>[o(t,{icon:_(te),onClick:D},null,8,["icon"])]),_:1}),o(n,{content:"缩小",placement:"top"},{default:v(()=>[o(t,{icon:_(ne),onClick:A},null,8,["icon"])]),_:1}),o(n,{content:"重置",placement:"top"},{default:v(()=>[o(t,{icon:_(oe),onClick:B},null,8,["icon"])]),_:1})]),_:1})]),c("div",pe,[o(n,{content:"测量工具",placement:"top"},{default:v(()=>[o(t,{icon:_(se),onClick:Z},null,8,["icon"])]),_:1}),o(n,{content:"标记",placement:"top"},{default:v(()=>[o(t,{icon:_(ie),onClick:$},null,8,["icon"])]),_:1})]),c("div",ge,[o(n,{content:"增大增益",placement:"top"},{default:v(()=>[o(t,{icon:_(ce),onClick:j},null,8,["icon"])]),_:1}),o(n,{content:"减小增益",placement:"top"},{default:v(()=>[o(t,{icon:_(re),onClick:F},null,8,["icon"])]),_:1}),o(n,{content:"增大速度",placement:"top"},{default:v(()=>[o(t,{icon:_(ue),onClick:X},null,8,["icon"])]),_:1}),o(n,{content:"减小速度",placement:"top"},{default:v(()=>[o(t,{icon:_(de),onClick:Y},null,8,["icon"])]),_:1})])]),c("div",Ve,[c("div",{class:"viewer-container",ref_key:"containerRef",ref:y},[c("canvas",{ref_key:"canvasRef",ref:h,class:"ecg-canvas"},null,512),R(c("div",be,[c("div",{class:"measure-line",style:ve(L.value)},null,4),c("div",ke,b(G.value),1)],512),[[O,g.value]]),R(c("div",we,null,512),[[O,V.value]])],512)]),c("div",Te,[c("div",Ie,[c("span",null,"增益: "+b(p.value)+"mm/mV",1),c("span",null,"速度: "+b(r.value)+"mm/s",1),c("span",null,"缩放: "+b(i.value)+"%",1)])])])}}},Se=K(Me,[["__scopeId","data-v-2047b7e8"]]);export{Se as E};
